{"version":3,"file":"resolveRefs.js","sourceRoot":"","sources":["../../src/dom/resolveRefs.ts"],"names":[],"mappings":";;;AAAA,qGAAqE;AACrE,6FAA6D;AAC7D,2CAA8C;AAC9C,sEAAsC;AAEtC,MAAM,aAAa,GAAG,IAAI,MAAM,CAC9B,4CAA4C,EAC5C,GAAG,CACJ,CAAC;AAEF,MAAM,aAAa,GAAG,IAAI,MAAM,CAC9B,oBAAoB,2BAAe,CAAC,MAAM,MAAM,EAChD,GAAG,CACJ,CAAC;AAEF,MAAM,WAAW,GAAG,CAAC,IAAY,EAAU,EAAE;IAC3C,OAAO,IAAI;SACR,OAAO,CAAC,aAAa,EAAE,CAAC,KAAK,EAAE,GAAG,EAAE,QAAQ,EAAE,EAAE;QAC/C,MAAM,QAAQ,GAAG,IAAA,+BAAqB,EAAC,QAAQ,CAAC,CAAC;QACjD,OAAO,KAAK,CAAC,OAAO,CAAC,GAAG,EAAE,GAAG,IAAA,oBAAU,EAAC,QAAQ,CAAC,EAAE,CAAC,CAAC;IACvD,CAAC,CAAC;SACD,OAAO,CAAC,aAAa,EAAE,CAAC,KAAK,EAAE,GAAG,EAAE,QAAQ,EAAE,EAAE;QAC/C,OAAO,KAAK,CAAC,OAAO,CAAC,GAAG,EAAE,GAAG,IAAA,oBAAU,EAAC,QAAQ,CAAC,EAAE,CAAC,CAAC;IACvD,CAAC,CAAC;SACD,OAAO,CAAC,IAAI,MAAM,CAAC,2BAAe,EAAE,GAAG,CAAC,EAAE,CAAC,CAAC,EAAE,QAAQ,EAAE,EAAE;QACzD,MAAM,SAAS,GAAG,IAAA,2BAAiB,EAAC,QAAQ,CAAC,CAAC;QAC9C,OAAO,SAAS,IAAI,QAAQ,CAAC;IAC/B,CAAC,CAAC,CAAC;AACP,CAAC,CAAC;AAEF,kBAAe,WAAW,CAAC","sourcesContent":["import getPageUidByPageTitle from \"../queries/getPageUidByPageTitle\";\nimport getTextByBlockUid from \"../queries/getTextByBlockUid\";\nimport { BLOCK_REF_REGEX } from \"./constants\";\nimport getRoamUrl from \"./getRoamUrl\";\n\nconst aliasTagRegex = new RegExp(\n  `\\\\[[^\\\\]]*\\\\]\\\\((\\\\[\\\\[([^\\\\]]*)\\\\]\\\\])\\\\)`,\n  \"g\"\n);\n\nconst aliasRefRegex = new RegExp(\n  `\\\\[[^\\\\]]*\\\\]\\\\((${BLOCK_REF_REGEX.source})\\\\)`,\n  \"g\"\n);\n\nconst resolveRefs = (text: string): string => {\n  return text\n    .replace(aliasTagRegex, (alias, del, pageName) => {\n      const blockUid = getPageUidByPageTitle(pageName);\n      return alias.replace(del, `${getRoamUrl(blockUid)}`);\n    })\n    .replace(aliasRefRegex, (alias, del, blockUid) => {\n      return alias.replace(del, `${getRoamUrl(blockUid)}`);\n    })\n    .replace(new RegExp(BLOCK_REF_REGEX, \"g\"), (_, blockUid) => {\n      const reference = getTextByBlockUid(blockUid);\n      return reference || blockUid;\n    });\n};\n\nexport default resolveRefs;\n"]}