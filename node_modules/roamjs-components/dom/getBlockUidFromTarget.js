"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
const tslib_1 = require("tslib");
const getNthChildUidByBlockUid_1 = tslib_1.__importDefault(require("../queries/getNthChildUidByBlockUid"));
const getReferenceBlockUid_1 = tslib_1.__importDefault(require("./getReferenceBlockUid"));
const getUids_1 = tslib_1.__importDefault(require("./getUids"));
const getBlockUidFromTarget = (target) => {
    const ref = target.closest(".rm-block-ref");
    if (ref) {
        return ref.getAttribute("data-uid") || "";
    }
    const customView = target.closest(".roamjs-block-view");
    if (customView) {
        return (0, getUids_1.default)(customView).blockUid;
    }
    const aliasTooltip = target.closest(".rm-alias-tooltip__content");
    if (aliasTooltip) {
        const aliasRef = document.querySelector(".bp3-popover-open .rm-alias--block");
        return (0, getReferenceBlockUid_1.default)(aliasRef, "rm-alias--block");
    }
    const { blockUid } = (0, getUids_1.default)(target.closest(".roam-block"));
    const kanbanTitle = target.closest(".kanban-title");
    if (kanbanTitle) {
        const container = kanbanTitle.closest(".kanban-column-container");
        if (container) {
            const column = kanbanTitle.closest(".kanban-column");
            const order = Array.from(container.children).findIndex((d) => d === column);
            return (0, getNthChildUidByBlockUid_1.default)({ blockUid, order });
        }
    }
    return blockUid;
};
exports.default = getBlockUidFromTarget;
//# sourceMappingURL=getBlockUidFromTarget.js.map