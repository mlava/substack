"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.setInputSettings = void 0;
const tslib_1 = require("tslib");
const getBasicTreeByParentUid_1 = tslib_1.__importDefault(require("../queries/getBasicTreeByParentUid"));
const deleteBlock_1 = tslib_1.__importDefault(require("../writes/deleteBlock"));
const createBlock_1 = tslib_1.__importDefault(require("../writes/createBlock"));
const toFlexRegex_1 = tslib_1.__importDefault(require("./toFlexRegex"));
const setInputSettings = ({ blockUid, values, key, index = 0, }) => {
    const tree = (0, getBasicTreeByParentUid_1.default)(blockUid);
    const keyNode = tree.find((t) => (0, toFlexRegex_1.default)(key).test(t.text));
    if (keyNode) {
        keyNode.children
            .filter(({ text }) => !values.includes(text))
            .forEach(({ uid }) => (0, deleteBlock_1.default)(uid));
        values.forEach((text, order) => !keyNode.children.some(({ text: c }) => text === c) &&
            (0, createBlock_1.default)({ node: { text }, order, parentUid: keyNode.uid }));
    }
    else {
        (0, createBlock_1.default)({
            parentUid: blockUid,
            order: index,
            node: { text: key, children: values.map((text) => ({ text })) },
        });
    }
};
exports.setInputSettings = setInputSettings;
exports.default = exports.setInputSettings;
//# sourceMappingURL=setInputSettings.js.map