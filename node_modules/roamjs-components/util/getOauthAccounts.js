"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
const tslib_1 = require("tslib");
const getShallowTreeByParentUid_1 = tslib_1.__importDefault(require("../queries/getShallowTreeByParentUid"));
const getPageUidByPageTitle_1 = tslib_1.__importDefault(require("../queries/getPageUidByPageTitle"));
const localStorageGet_1 = tslib_1.__importDefault(require("./localStorageGet"));
const toConfigPageName_1 = tslib_1.__importDefault(require("./toConfigPageName"));
const toFlexRegex_1 = tslib_1.__importDefault(require("./toFlexRegex"));
const getOauthAccounts = (service) => {
    const fromStorage = (0, localStorageGet_1.default)(`oauth-${service}`);
    if (fromStorage) {
        const accounts = JSON.parse(fromStorage);
        return accounts.map((a) => a.text);
    }
    const tree = (0, getShallowTreeByParentUid_1.default)((0, getPageUidByPageTitle_1.default)((0, toConfigPageName_1.default)(service)));
    const node = tree.find((s) => (0, toFlexRegex_1.default)("oauth").test(s.text.trim()));
    if (!node) {
        return [];
    }
    return (0, getShallowTreeByParentUid_1.default)(node.uid).map((t) => t.text);
};
exports.default = getOauthAccounts;
//# sourceMappingURL=getOauthAccounts.js.map