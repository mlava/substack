"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
const tslib_1 = require("tslib");
const env_1 = require("./env");
const handleFetch_1 = tslib_1.__importDefault(require("./handleFetch"));
const handleBodyFetch = (method) => (args, _data) => {
    const _a = typeof args === "string" ? { path: args, data: _data } : args, { data } = _a, fetchArgs = tslib_1.__rest(_a, ["data"]);
    return (0, handleFetch_1.default)((url, init) => {
        const body = data instanceof Uint8Array
            ? data
            : (0, env_1.getNodeEnv)() === "development" &&
                /(localhost|roamjs)/.test(url.toString())
                ? JSON.stringify(Object.assign({ dev: true }, data))
                : JSON.stringify(data || {});
        return [
            url,
            Object.assign(Object.assign({}, init), { body, headers: Object.fromEntries(Object.entries(Object.assign({ "Content-Type": "application/json" }, init === null || init === void 0 ? void 0 : init.headers)).filter((h) => !!h[1])), method }),
        ];
    }, fetchArgs);
};
exports.default = handleBodyFetch;
//# sourceMappingURL=handleBodyFetch.js.map