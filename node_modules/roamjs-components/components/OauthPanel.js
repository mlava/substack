"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
const tslib_1 = require("tslib");
const core_1 = require("@blueprintjs/core");
const react_1 = tslib_1.__importStar(require("react"));
const localStorageGet_1 = tslib_1.__importDefault(require("../util/localStorageGet"));
const localStorageSet_1 = require("../util/localStorageSet");
const ExternalLogin_1 = tslib_1.__importDefault(require("./ExternalLogin"));
const OauthPanel = (options) => {
    const key = `oauth-${options.service}`;
    const [accounts, setAccounts] = (0, react_1.useState)(() => JSON.parse((0, localStorageGet_1.default)(key) || "[]"));
    return (react_1.default.createElement("div", { className: "flex flex-col gap-1", style: { minWidth: 300 } },
        react_1.default.createElement(ExternalLogin_1.default, Object.assign({ useLocal: true, onSuccess: (acc) => setAccounts([...accounts, acc]), parentUid: "", loggedIn: !!accounts.length }, options)),
        !!accounts.length && (react_1.default.createElement(react_1.default.Fragment, null,
            react_1.default.createElement("h5", { className: "margin-0" }, "Accounts"),
            react_1.default.createElement("ul", { className: "margin-0" }, accounts.map((act) => (react_1.default.createElement("li", { key: act.uid, style: {
                    display: "flex",
                    justifyContent: "space-between",
                    alignItems: "center",
                    marginTop: 8,
                } },
                react_1.default.createElement("span", { style: { minWidth: 192 } }, act.text),
                react_1.default.createElement(core_1.Button, { text: "Log Out", onClick: () => {
                        const accts = JSON.parse((0, localStorageGet_1.default)(key));
                        (0, localStorageSet_1.localStorageSet)(key, JSON.stringify(accts.filter((a) => act.uid !== a.uid)));
                        setAccounts(accounts.filter((a) => act.uid !== a.uid));
                    } })))))))));
};
OauthPanel.type = "oauth";
exports.default = OauthPanel;
//# sourceMappingURL=OauthPanel.js.map