{"version":3,"file":"ComponentContainer.js","sourceRoot":"","sources":["../../src/components/ComponentContainer.tsx"],"names":[],"mappings":";;;;AAAA,4CAA2C;AAC3C,uDAAqD;AACrD,iFAAiD;AACjD,iGAAiE;AACjE,0FAA0D;AAG1D,MAAM,kBAAkB,GAGnB,CAAC,EAAE,OAAO,EAAE,SAAS,EAAE,QAAQ,EAAE,EAAE,EAAE;IACxC,MAAM,CAAC,SAAS,EAAE,YAAY,CAAC,GAAG,IAAA,gBAAQ,EAAC,KAAK,CAAC,CAAC;IAClD,MAAM,MAAM,GAAG,IAAA,mBAAW,EAAC,GAAG,EAAE,CAAC,YAAY,CAAC,IAAI,CAAC,EAAE,CAAC,YAAY,CAAC,CAAC,CAAC;IACrE,MAAM,SAAS,GAAG,IAAA,mBAAW,EAAC,GAAG,EAAE,CAAC,YAAY,CAAC,KAAK,CAAC,EAAE,CAAC,YAAY,CAAC,CAAC,CAAC;IAEzE,MAAM,EAAE,QAAQ,EAAE,QAAQ,EAAE,GAAG,IAAA,uBAAa,EAAC,OAAO,CAAC,CAAC;IACtD,OAAO,CACL,uCACE,SAAS,EAAE,SAAS,EACpB,WAAW,EAAE,MAAM,EACnB,YAAY,EAAE,SAAS,EACvB,KAAK,EAAE,EAAE,QAAQ,EAAE,UAAU,EAAE,KAAK,EAAE,aAAa,EAAE,QAAQ,EAAE,GAAG,EAAE;QAEnE,SAAS,IAAI,CACZ,uCAAK,SAAS,EAAE,mDAAmD,IAChE,OAAO,IAAI,CACV,8BAAC,aAAM,IACL,IAAI,EAAC,MAAM,EACX,OAAO,QACP,OAAO,EAAE,GAAG,EAAE,CACZ,MAAM,CAAC,YAAY,CAAC,EAAE,CAAC,yBAAyB,CAAC;gBAC/C,QAAQ,EAAE,EAAE,WAAW,EAAE,QAAQ,EAAE,WAAW,EAAE,QAAQ,EAAE;aAC3D,CAAC,GAEJ,CACH,CACG,CACP;QACA,QAAQ,CACL,CACP,CAAC;AACJ,CAAC,CAAC;AAEK,MAAM,qBAAqB,GAChC,CACE,EAAuD,EACvD,SAAkB,EAClB,EAAE,CACJ,CAAC,CAAoB,EAAE,IAAiB,EAAQ,EAAE;;IAChD,IAAI,CAAC,CAAC,aAAa,EAAE;QACnB,CAAC,CAAC,aAAa,CAAC,WAAW,GAAG,CAAC,CAAa,EAAE,EAAE,CAAC,CAAC,CAAC,eAAe,EAAE,CAAC;QACrE,MAAM,QAAQ,GAAG,IAAA,+BAAqB,EAAC,CAAC,CAAC,CAAC;QAC1C,MAAM,eAAe,GAAG,MAAA,CAAC,CAAC,OAAO,CAAC,aAAa,CAAC,0CAAE,EAAE,CAAC;QACrD,MAAM,OAAO,GAAG,CAAA,MAAA,eAAe,aAAf,eAAe,uBAAf,eAAe,CAAE,QAAQ,gEAAG,QAAQ,CAAC;YACnD,CAAC,CAAC,eAAe;YACjB,CAAC,CAAC,SAAS,CAAC;QACd,IAAI,QAAQ,EAAE;YACZ,IAAA,2BAAiB,EACf,8BAAC,kBAAkB,IAAC,OAAO,EAAE,OAAO,EAAE,SAAS,EAAE,SAAS;gBACxD,8BAAC,EAAE,IAAC,QAAQ,EAAE,QAAQ,GAAI,CACP,EACrB,CAAC,CAAC,aAAa,EACf,IAAI,CACL,CAAC;SACH;KACF;AACH,CAAC,CAAC;AAvBS,QAAA,qBAAqB,yBAuB9B;AAEJ,kBAAe,kBAAkB,CAAC","sourcesContent":["import { Button } from \"@blueprintjs/core\";\nimport React, { useCallback, useState } from \"react\";\nimport getUidsFromId from \"../dom/getUidsFromId\";\nimport getBlockUidFromTarget from \"../dom/getBlockUidFromTarget\";\nimport renderWithUnmount from \"../util/renderWithUnmount\";\nimport { OnloadArgs } from \"../types/native\";\n\nconst ComponentContainer: React.FunctionComponent<{\n  blockId?: string;\n  className?: string;\n}> = ({ blockId, className, children }) => {\n  const [showIcons, setShowIcons] = useState(false);\n  const appear = useCallback(() => setShowIcons(true), [setShowIcons]);\n  const disappear = useCallback(() => setShowIcons(false), [setShowIcons]);\n\n  const { blockUid, windowId } = getUidsFromId(blockId);\n  return (\n    <div\n      className={className}\n      onMouseOver={appear}\n      onMouseLeave={disappear}\n      style={{ position: \"relative\", width: \"fit-content\", minWidth: 300 }}\n    >\n      {showIcons && (\n        <div className={\"roamjs-edit-component absolute top-2 right-2 z-50\"}>\n          {blockId && (\n            <Button\n              icon=\"edit\"\n              minimal\n              onClick={() =>\n                window.roamAlphaAPI.ui.setBlockFocusAndSelection({\n                  location: { \"block-uid\": blockUid, \"window-id\": windowId },\n                })\n              }\n            />\n          )}\n        </div>\n      )}\n      {children}\n    </div>\n  );\n};\n\nexport const createComponentRender =\n  (\n    Fc: (props: { blockUid: string }) => React.ReactElement,\n    className?: string\n  ) =>\n  (b: HTMLButtonElement, args?: OnloadArgs): void => {\n    if (b.parentElement) {\n      b.parentElement.onmousedown = (e: MouseEvent) => e.stopPropagation();\n      const blockUid = getBlockUidFromTarget(b);\n      const possibleBlockId = b.closest(\".roam-block\")?.id;\n      const blockId = possibleBlockId?.endsWith?.(blockUid)\n        ? possibleBlockId\n        : undefined;\n      if (blockUid) {\n        renderWithUnmount(\n          <ComponentContainer blockId={blockId} className={className}>\n            <Fc blockUid={blockUid} />\n          </ComponentContainer>,\n          b.parentElement,\n          args\n        );\n      }\n    }\n  };\n\nexport default ComponentContainer;\n"]}