{"version":3,"file":"useSingleChildValue.js","sourceRoot":"","sources":["../../../src/components/ConfigPanels/useSingleChildValue.tsx"],"names":[],"mappings":";;;AAAA,iCAA8C;AAC9C,kHAAkF;AAClF,gGAAgE;AAEhE,MAAM,mBAAmB,GAAG,CAAmC,EAC7D,YAAY,EACZ,GAAG,EAAE,UAAU,EACf,KAAK,EACL,SAAS,EACT,KAAK,EACL,SAAS,EACT,KAAK,GASN,EAA0C,EAAE;IAC3C,MAAM,CAAC,GAAG,EAAE,MAAM,CAAC,GAAG,IAAA,gBAAQ,EAAC,UAAU,CAAC,CAAC;IAC3C,MAAM,CAAC,QAAQ,EAAE,WAAW,CAAC,GAAG,IAAA,gBAAQ,EACtC,GAAG,IAAI,IAAA,oCAA0B,EAAC,GAAG,CAAC,CACvC,CAAC;IACF,MAAM,CAAC,KAAK,EAAE,QAAQ,CAAC,GAAG,IAAA,gBAAQ,EAChC,CAAC,QAAQ,IAAI,SAAS,CAAC,IAAA,2BAAiB,EAAC,QAAQ,CAAC,CAAC,CAAC,IAAI,YAAY,CACrE,CAAC;IACF,MAAM,QAAQ,GAAG,IAAA,mBAAW,EAC1B,CAAC,CAAI,EAAE,EAAE;QACP,QAAQ,CAAC,CAAC,CAAC,CAAC;QACZ,IAAI,QAAQ,EAAE;YACZ,MAAM,CAAC,YAAY,CAAC,WAAW,CAAC;gBAC9B,KAAK,EAAE,EAAE,MAAM,EAAE,KAAK,CAAC,CAAC,CAAC,EAAE,GAAG,EAAE,QAAQ,EAAE;aAC3C,CAAC,CAAC;SACJ;aAAM,IAAI,GAAG,EAAE;YACd,MAAM,WAAW,GAAG,MAAM,CAAC,YAAY,CAAC,IAAI,CAAC,WAAW,EAAE,CAAC;YAC3D,MAAM,CAAC,YAAY,CAAC,WAAW,CAAC;gBAC9B,KAAK,EAAE,EAAE,MAAM,EAAE,KAAK,CAAC,CAAC,CAAC,EAAE,GAAG,EAAE,WAAW,EAAE;gBAC7C,QAAQ,EAAE,EAAE,KAAK,EAAE,CAAC,EAAE,YAAY,EAAE,GAAG,EAAE;aAC1C,CAAC,CAAC;YACH,WAAW,CAAC,WAAW,CAAC,CAAC;SAC1B;aAAM;YACL,MAAM,MAAM,GAAG,MAAM,CAAC,YAAY,CAAC,IAAI,CAAC,WAAW,EAAE,CAAC;YACtD,MAAM,CAAC,YAAY,CAAC,WAAW,CAAC;gBAC9B,KAAK,EAAE,EAAE,MAAM,EAAE,KAAK,EAAE,GAAG,EAAE,MAAM,EAAE;gBACrC,QAAQ,EAAE,EAAE,KAAK,EAAE,YAAY,EAAE,SAAS,EAAE;aAC7C,CAAC,CAAC;YACH,UAAU,CAAC,GAAG,EAAE,CAAC,MAAM,CAAC,MAAM,CAAC,CAAC,CAAC;YACjC,MAAM,WAAW,GAAG,MAAM,CAAC,YAAY,CAAC,IAAI,CAAC,WAAW,EAAE,CAAC;YAC3D,MAAM,CAAC,YAAY,CAAC,WAAW,CAAC;gBAC9B,KAAK,EAAE,EAAE,MAAM,EAAE,KAAK,CAAC,CAAC,CAAC,EAAE,GAAG,EAAE,WAAW,EAAE;gBAC7C,QAAQ,EAAE,EAAE,KAAK,EAAE,CAAC,EAAE,YAAY,EAAE,MAAM,EAAE;aAC7C,CAAC,CAAC;YACH,WAAW,CAAC,WAAW,CAAC,CAAC;SAC1B;IACH,CAAC,EACD,CAAC,QAAQ,EAAE,WAAW,EAAE,KAAK,EAAE,SAAS,EAAE,KAAK,EAAE,GAAG,EAAE,QAAQ,EAAE,MAAM,CAAC,CACxE,CAAC;IACF,OAAO,EAAE,KAAK,EAAE,QAAQ,EAAE,CAAC;AAC7B,CAAC,CAAC;AAEF,kBAAe,mBAAmB,CAAC","sourcesContent":["import { useCallback, useState } from \"react\";\nimport getFirstChildUidByBlockUid from \"../../queries/getFirstChildUidByBlockUid\";\nimport getTextByBlockUid from \"../../queries/getTextByBlockUid\";\n\nconst useSingleChildValue = <T extends string | number | Date>({\n  defaultValue,\n  uid: initialUid,\n  title,\n  parentUid,\n  order,\n  transform,\n  toStr,\n}: {\n  title: string;\n  parentUid: string;\n  order: number;\n  uid?: string;\n  defaultValue: T;\n  transform: (s: string) => T;\n  toStr: (t: T) => string;\n}): { value: T; onChange: (v: T) => void } => {\n  const [uid, setUid] = useState(initialUid);\n  const [valueUid, setValueUid] = useState(\n    uid && getFirstChildUidByBlockUid(uid)\n  );\n  const [value, setValue] = useState(\n    (valueUid && transform(getTextByBlockUid(valueUid))) || defaultValue\n  );\n  const onChange = useCallback(\n    (v: T) => {\n      setValue(v);\n      if (valueUid) {\n        window.roamAlphaAPI.updateBlock({\n          block: { string: toStr(v), uid: valueUid },\n        });\n      } else if (uid) {\n        const newValueUid = window.roamAlphaAPI.util.generateUID();\n        window.roamAlphaAPI.createBlock({\n          block: { string: toStr(v), uid: newValueUid },\n          location: { order: 0, \"parent-uid\": uid },\n        });\n        setValueUid(newValueUid);\n      } else {\n        const newUid = window.roamAlphaAPI.util.generateUID();\n        window.roamAlphaAPI.createBlock({\n          block: { string: title, uid: newUid },\n          location: { order, \"parent-uid\": parentUid },\n        });\n        setTimeout(() => setUid(newUid));\n        const newValueUid = window.roamAlphaAPI.util.generateUID();\n        window.roamAlphaAPI.createBlock({\n          block: { string: toStr(v), uid: newValueUid },\n          location: { order: 0, \"parent-uid\": newUid },\n        });\n        setValueUid(newValueUid);\n      }\n    },\n    [setValue, setValueUid, title, parentUid, order, uid, valueUid, setUid]\n  );\n  return { value, onChange };\n};\n\nexport default useSingleChildValue;\n"]}