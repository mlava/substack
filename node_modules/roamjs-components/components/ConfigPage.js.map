{"version":3,"file":"ConfigPage.js","sourceRoot":"","sources":["../../src/components/ConfigPage.tsx"],"names":[],"mappings":"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","sourcesContent":["import { Card, Tab, Tabs } from \"@blueprintjs/core\";\nimport React, { useCallback, useMemo, useRef, useState } from \"react\";\nimport ReactDOM from \"react-dom\";\nimport createHTMLObserver from \"../dom/createHTMLObserver\";\nimport createBlock from \"../writes/createBlock\";\nimport createPage from \"../writes/createPage\";\nimport getBasicTreeByParentUid from \"../queries/getBasicTreeByParentUid\";\nimport getPageUidByPageTitle from \"../queries/getPageUidByPageTitle\";\nimport getShallowTreeByParentUid from \"../queries/getShallowTreeByParentUid\";\nimport localStorageGet from \"../util/localStorageGet\";\nimport idToTitle from \"../util/idToTitle\";\nimport type { Field, UnionField } from \"./ConfigPanels/types\";\nimport { Brand } from \"./ConfigPanels/getBrandColors\";\nimport { InputTextNode } from \"../types\";\n\ntype ConfigTab = {\n  id: string;\n  toggleable?: boolean | \"premium\";\n  onEnable?: () => void;\n  onDisable?: () => void;\n  development?: boolean;\n  fields: Field<UnionField>[];\n};\n\ntype Config =\n  | {\n      tabs: ConfigTab[];\n      versioning?: boolean;\n      brand?: Brand;\n    }\n  | Field<UnionField>[];\n\nconst FieldTabs = ({\n  id,\n  fields,\n  uid,\n  pageUid,\n  order,\n  toggleable,\n}: {\n  uid: string;\n  pageUid: string;\n  order: number;\n  extensionId: string;\n} & ConfigTab) => {\n  const parentUid = useMemo(() => {\n    if (/home/i.test(id)) {\n      return pageUid;\n    }\n    if (uid) {\n      return uid;\n    }\n    if (toggleable) {\n      return \"\";\n    }\n    const newUid = window.roamAlphaAPI.util.generateUID();\n    createBlock({\n      parentUid: pageUid,\n      order,\n      node: { text: id, uid: newUid },\n    });\n    return newUid;\n  }, [pageUid, uid, id, toggleable]);\n  const childUids = Object.fromEntries(\n    getShallowTreeByParentUid(parentUid).map(({ text, uid }) => [\n      text.toLowerCase().trim(),\n      uid,\n    ])\n  );\n  const [selectedTabId, setSelectedTabId] = useState(\n    fields.length && typeof toggleable !== \"string\"\n      ? fields[0].title\n      : \"enabled\"\n  );\n  const onTabsChange = useCallback(\n    (tabId: string) => setSelectedTabId(tabId),\n    [setSelectedTabId]\n  );\n  return (\n    <Tabs\n      vertical\n      id={`${id}-field-tabs`}\n      onChange={onTabsChange}\n      selectedTabId={selectedTabId}\n      renderActiveTabPanelOnly\n    >\n      {fields.map((field, i) => {\n        const { Panel, title, defaultValue } = field;\n        return (\n          <Tab\n            id={title}\n            key={title}\n            title={idToTitle(title)}\n            panel={\n              <Panel\n                {...field}\n                defaultValue={defaultValue}\n                order={i}\n                parentUid={parentUid}\n                uid={childUids[title.toLowerCase()]}\n              />\n            }\n          />\n        );\n      })}\n    </Tabs>\n  );\n};\n\nconst ConfigPage = ({\n  id,\n  config,\n  pageUid,\n}: {\n  id: string;\n  config: Config;\n  pageUid: string;\n}): React.ReactElement => {\n  const isLegacy = \"tabs\" in config;\n  const userTabs = isLegacy\n    ? config.tabs.filter((t) => t.fields.length || t.toggleable)\n    : [{ fields: config, id: \"home\" }];\n  const [selectedTabId, setSelectedTabId] = useState(userTabs[0]?.id);\n  const onTabsChange = useCallback(\n    (tabId: string) => setSelectedTabId(tabId),\n    [setSelectedTabId]\n  );\n  const tree = getBasicTreeByParentUid(pageUid);\n\n  // first character trimmed intentionally for the `v` below\n  const titleRef = useRef<HTMLDivElement>(null);\n  const experimentalMode = useMemo(() => localStorageGet(\"experimental\"), []);\n  return (\n    <Card style={{ color: \"#202B33\" }} className={\"roamjs-config-panel\"}>\n      <div\n        style={{ display: \"flex\", justifyContent: \"space-between\" }}\n        ref={titleRef}\n        tabIndex={-1}\n      >\n        <h4 style={{ padding: 4 }}>{idToTitle(id)} Configuration</h4>\n      </div>\n      <style>{`.roamjs-config-tabs {\\npadding: 4px;\\n}`}</style>\n      {isLegacy ? (\n        <Tabs\n          id={`${id}-config-tabs`}\n          onChange={onTabsChange}\n          selectedTabId={selectedTabId}\n          renderActiveTabPanelOnly\n          className={\"roamjs-config-tabs\"}\n        >\n          {userTabs.map(\n            (\n              {\n                id: tabId,\n                fields,\n                toggleable,\n                development = false,\n                onEnable,\n                onDisable,\n              },\n              i\n            ) => (\n              <Tab\n                id={tabId}\n                key={tabId}\n                title={idToTitle(tabId)}\n                disabled={development && !experimentalMode}\n                panel={\n                  <FieldTabs\n                    id={tabId}\n                    extensionId={id}\n                    fields={fields}\n                    uid={\n                      tree.find((t) => new RegExp(tabId, \"i\").test(t.text))\n                        ?.uid || \"\"\n                    }\n                    pageUid={pageUid}\n                    order={i}\n                    toggleable={toggleable}\n                    onEnable={onEnable}\n                    onDisable={onDisable}\n                  />\n                }\n              />\n            )\n          )}\n        </Tabs>\n      ) : (\n        <FieldTabs\n          id={\"home\"}\n          extensionId={id}\n          fields={config}\n          uid={pageUid}\n          pageUid={pageUid}\n          order={0}\n          toggleable={false}\n        />\n      )}\n    </Card>\n  );\n};\n\n// TODO: better nested type discrimination here\nconst fieldsToChildren = (fields: Field<UnionField>[]) =>\n  fields\n    .filter((f) => !!f.defaultValue)\n    .map((f) => ({\n      text: f.title,\n      children:\n        f.Panel.type === \"flag\"\n          ? []\n          : f.Panel.type === \"custom\"\n          ? (f.defaultValue as InputTextNode[]) || []\n          : f.Panel.type === \"pages\" || f.Panel.type === \"multitext\"\n          ? (f.defaultValue as string[])?.map((v) => ({ text: v }))\n          : f.Panel.type === \"block\"\n          ? f.defaultValue\n            ? [f.defaultValue as InputTextNode]\n            : []\n          : [{ text: `${f.defaultValue}` }],\n    }));\n\nconst createConfigPage = ({\n  title,\n  config,\n}: {\n  title: string;\n  config: Config;\n}) => {\n  const homeTab =\n    \"tabs\" in config\n      ? config.tabs.find((t) => /home/i.test(t.id))?.fields\n      : config;\n  const rawTree = [\n    ...(homeTab ? fieldsToChildren(homeTab) : []),\n    ...(\"tabs\" in config\n      ? config.tabs\n          .filter((t) => !/home/i.test(t.id) && !t.toggleable && !t.development)\n          .map((t) => ({\n            text: t.id,\n            children: fieldsToChildren(t.fields),\n          }))\n      : []),\n  ];\n  return createPage({\n    title,\n    tree: rawTree.length ? rawTree : [{ text: \" \" }],\n  });\n};\n\nexport const render = ({\n  h,\n  title,\n  pageUid = getPageUidByPageTitle(title),\n  config,\n}: {\n  h: HTMLHeadingElement;\n  title: string;\n  pageUid?: string;\n  config: Config;\n}) => {\n  const uid = getPageUidByPageTitle(title);\n  const attribute = `data-roamjs-${uid}`;\n  const containerParent = h.parentElement?.parentElement;\n  if (containerParent && !containerParent.hasAttribute(attribute)) {\n    containerParent.setAttribute(attribute, \"true\");\n    const parent = document.createElement(\"div\");\n    const configPageId = title.split(\"/\").slice(-1)[0];\n    parent.id = `${configPageId}-config`;\n    containerParent.insertBefore(\n      parent,\n      h.parentElement?.nextElementSibling || null\n    );\n    ReactDOM.render(\n      <ConfigPage id={configPageId} config={config} pageUid={pageUid} />,\n      parent\n    );\n  }\n};\n\nexport const createConfigObserver = async ({\n  title,\n  config,\n}: {\n  title: string;\n  config: Config;\n}): Promise<{ pageUid: string; observer?: MutationObserver }> => {\n  const pageUid =\n    getPageUidByPageTitle(title) ||\n    (await createConfigPage({\n      title,\n      config,\n    }));\n  if (\"tabs\" in config ? !!config.tabs.length : !!config.length) {\n    const observer = createHTMLObserver({\n      className: \"rm-title-display\",\n      tag: \"H1\",\n      callback: (d: HTMLElement) => {\n        const h = d as HTMLHeadingElement;\n        if (h.innerText === title) {\n          render({\n            pageUid,\n            config,\n            title,\n            h,\n          });\n        }\n      },\n    });\n    return {\n      pageUid,\n      observer,\n    };\n  }\n  return {\n    pageUid,\n  };\n};\n\nexport default ConfigPage;\n"]}